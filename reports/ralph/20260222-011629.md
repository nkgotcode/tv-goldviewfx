# Ralph Run 2026-02-22 01:16:29

## What Changed
- Added range-list queries for BingX funding/open-interest/mark-index/ticker in Convex + Timescale repositories.
- Enriched dataset feature rows with aligned futures fields per candle timestamp.
- Extended RL-service training/evaluation schemas and API to accept leverage/fee/slippage/funding/drawdown and PPO feedback-loop parameters.
- Implemented futures-aware reward shaping in `MarketWindowEnv` and hard-window PPO feedback rounds in `sb3_trainer`.
- Updated evaluation trade/PnL logic to account for leverage, funding, taker fee + slippage, and drawdown penalty.
- Updated `fix_plan.md` with this completed slice.

## Proof Run
- `cd backend/rl-service && uv run pytest tests/unit/test_market_env.py tests/unit/test_sb3_trainer.py tests/unit/test_feature_parity.py tests/integration/test_evaluations_api.py -q`
- `cd backend && bun test tests/integration/rl_training.test.ts tests/integration/rl_evaluations.test.ts`
- `cd backend && bun test tests/integration/dashboard.test.ts`

## Open Risks
- Backend integration tests requiring DB are skipped without `DB_TEST_ENABLED=true`; full end-to-end promotion path still needs a DB-backed run.
- Nautilus strategy still operates on OHLCV bars only; futures context currently affects PPO train/eval reward and dataset-driven env observations, not Nautilus live bar callbacks.

## Next Item
- Add mission-control chart widgets for futures feature health and reward-config provenance per evaluation report (read from `metadata.reward_config`).
